<div class="container">
  <header>
    <h1>🛒 {{ title }}</h1>
    <nav class="header-nav">
      <div class="cart-icon">
        Sepet: {{ cart.length }} ürün
      </div>
      <div class="auth-buttons">
        <ng-container *ngIf="!authService.isLoggedIn()">
          <a routerLink="/login" class="nav-link">Giriş Yap</a>
          <a routerLink="/register" class="nav-link register-link">Kayıt Ol</a>
        </ng-container>
        <ng-container *ngIf="authService.isLoggedIn()">
          <span class="user-welcome">Hoş geldiniz, {{ authService.getCurrentUser()?.username }}!</span>
          <button (click)="authService.logout()" class="logout-btn">Çıkış</button>
        </ng-container>
      </div>
    </nav>
  </header>

  <router-outlet></router-outlet>

  <main>
    <section class="products">
      <h2>Ürünler</h2>
      <div class="product-grid">
        <div class="product-card" *ngFor="let product of products">
          <div class="product-image">{{ product.image }}</div>
          <h3>{{ product.name }}</h3>
          <p>{{ product.description }}</p>
          <div class="product-footer">
            <span class="price">{{ product.price }} ₺</span>
            <button (click)="addToCart(product)">Sepete Ekle</button>
          </div>
        </div>
      </div>
    </section>

    <section class="cart" *ngIf="cart.length > 0">
      <h2>Alışveriş Sepetim</h2>
      <div class="cart-items">
        <div class="cart-item" *ngFor="let item of cart; let i = index">
          <span>{{ item.image }} {{ item.name }}</span>
          <span>{{ item.price }} ₺</span>
          <button (click)="removeFromCart(i)" class="remove-btn">Sil</button>
        </div>
      </div>
      <div class="cart-total">
        <strong>Toplam: {{ getTotalPrice() }} ₺</strong>
      </div>
    </section>

    <!-- Push Notification Gönderme Bölümü -->
<div class="notification-section">
  <h2>📱 Push Bildirim Gönder</h2>

  <div class="notification-form">
    <div class="form-group">
      <label for="deviceToken">Device Token:</label>
      <input
        type="text"
        id="deviceToken"
        [(ngModel)]="deviceToken"
        placeholder="iOS Device Token giriniz"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="title">Bildirim Başlığı:</label>
      <input
        type="text"
        id="title"
        [(ngModel)]="notificationTitle"
        placeholder="Örn: Yeni Kampanya"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="body">Bildirim İçeriği:</label>
      <textarea
        id="body"
        [(ngModel)]="notificationBody"
        placeholder="Örn: %50 indirim fırsatını kaçırmayın!"
        rows="3"
        class="form-input"
      ></textarea>
    </div>

    <button
      (click)="sendPushNotification()"
      [disabled]="isSendingNotification"
      class="send-btn"
    >
      {{ isSendingNotification ? '⏳ Gönderiliyor...' : '📤 Bildirim Gönder' }}
    </button>

    <div *ngIf="notificationMessage" [class]="notificationMessage.includes('✅') ? 'success-message' : 'error-message'">
      {{ notificationMessage }}
    </div>
  </div>
</div>
  </main>
</div>
